<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <!-- css -->
    <link rel="stylesheet" href="/style.css">
    <title>Visitantes</title>
</head>

<body>

    <section class="_table_container" id="_table_container"> 

        <!-- loader -->
        <section id="_loader"> 
            <div style="display: flex; padding: 20px; height: 200px; width: 100%; justify-content:center; align-items: center;"> 
                <svg class="stroke-current" width="64" height="64" viewBox="0 0 44 44" stroke="#000"> 
                    <g fill="none" fill-rule="evenodd" stroke-width="2"> 
                        <circle cx="22" cy="22" r="1"> 
                            <animate attributeName="r" begin="0s" dur="1.8s" values="1; 20" calcMode="spline" keyTimes="0; 1" keySplines="0.165, 0.84, 0.44, 1" repeatCount="indefinite"></animate> 
                            <animate attributeName="stroke-opacity" begin="0s" dur="1.8s" values="1; 0" calcMode="spline" keyTimes="0; 1" keySplines="0.3, 0.61, 0.355, 1" repeatCount="indefinite"></animate> 
                        </circle> 
                        <circle cx="22" cy="22" r="1"> 
                            <animate attributeName="r" begin="-0.9s" dur="1.8s" values="1; 20" calcMode="spline" keyTimes="0; 1" keySplines="0.165, 0.84, 0.44, 1" repeatCount="indefinite"></animate> 
                            <animate attributeName="stroke-opacity" begin="-0.9s" dur="1.8s" values="1; 0" calcMode="spline" keyTimes="0; 1" keySplines="0.3, 0.61, 0.355, 1" repeatCount="indefinite"></animate> 
                        </circle> 
                    </g> 
                </svg> 
            </div> 
        </section> 
        <main>
            <img style="width: 300px; margin: auto;" src="/logo-nvs.png" alt="logo NVS">

            <!-- table -->
            <div id="_table_content" style="display:none;"> 

                <div style="display:flex; justify-content: flex-end; margin: 0; padding: 0;"> 
                    <input onkeyup="form_search_change()" id="form_search" class="form_search" type="text" placeholder="Procurar"> 
                </div> 
                    
                <div id="_table_scroll"> 
                    <table class="_table" id="_table"> 
                        <thead> 
                            <tr> 
                                <th onclick="sort_table(1)" class="sortable"> Nome 
                                    <svg class="sort_icon" xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 24 24">
                                        <path d="M12 0l8 10h-16l8-10zm8 14h-16l8 10 8-10z"></path>
                                    </svg> 
                                </th> 

                                <th onclick="sort_table(2)" class="sortable"> Sobrenome 
                                    <svg class="sort_icon" xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 24 24">
                                        <path d="M12 0l8 10h-16l8-10zm8 14h-16l8 10 8-10z"></path>
                                    </svg> 
                                </th> 

                                <th onclick="sort_table(6)" class="sortable"> Motivo da Visita 
                                    <svg class="sort_icon" xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 24 24">
                                        <path d="M12 0l8 10h-16l8-10zm8 14h-16l8 10 8-10z"></path>
                                    </svg> 
                                </th> 

                                <th class="sortable" onclick="sort_table(7)"> Observações 
                                    <svg class="sort_icon" xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 24 24">
                                        <path d="M12 0l8 10h-16l8-10zm8 14h-16l8 10 8-10z"></path>
                                    </svg> 
                                </th>  
                            </tr> 
                        </thead> 

                        <tbody id="_sheetdb_content" data-api-url="https://sheetdb.io/api/v1/gvcfuj7xvh37c"></tbody>

                        <tbody>
                            <tr id="_no_results_found" style="display: none;"> 
                                <td colspan="8" style="text-align: center;"> Sem Resultados </td> 
                            </tr> 
                        </tbody>
                    </table> 
                </div>
                <br>
                <div style="display:flex; align-items: center; justify-content: space-between;">
                    <a class="_form_input_submit" style="text-align: center;" href="/index.html">
                        Novo Cadastro
                    </a>
                </div>

                <div id="snippet_error" style="display: none;"> 
                    <h2>Algo deu errado. Entre em contato com o suporte.</h2>  
                </div> 
            </div> 
        </main>

</body>

<script>
    document.addEventListener("DOMContentLoaded",load_content); var data = null; window.load_content = load_content; function load_content(e, visableColumns = null, searchableColumns = null) { let content = document.getElementById("_sheetdb_content"); if(!content) { return null; } let appContent = document.getElementById("_table_content"); let loader = document.getElementById("_loader"); let apiUrl = content.dataset.apiUrl; let errorNode = document.getElementById("snippet_error"); appContent.style.display = 'none'; loader.style.display = 'block'; if (!visableColumns) { visableColumns = JSON.parse('["Nome","Sobrenome","Motivo da Visita","Observa\u00e7\u00f5es"]'); } if (!searchableColumns) { searchableColumns = JSON.parse('["Data da Visita","Nome","Sobrenome","Telefone","Data de Nascimento","CPF","Motivo da Visita","Observa\u00e7\u00f5es"]'); } if (data) { data.forEach((row) => { let rowNode = document.createElement('tr'); visableColumns.forEach((column) => { let colNode = document.createElement('td'); colNode.innerHTML = row[column]; colNode.dataset.label = column; colNode.dataset.searchable = searchableColumns.includes(column) ? "true" : "false"; rowNode.appendChild(colNode); }); content.appendChild(rowNode); appContent.style.display = ''; loader.style.display = 'none'; }); return; } if (apiUrl) { content.innerHTML = ''; fetch(apiUrl) .then((response) => { if (response.status !== 200) { loader.style.display = 'none'; errorNode.style.display = 'flex'; return false; } return response.json(); }) .then((data) => { if (!data) { loader.style.display = 'none'; errorNode.style.display = 'flex'; } data = data; data.forEach((row) => { let rowNode = document.createElement('tr'); visableColumns.forEach((column) => { let colNode = document.createElement('td'); colNode.innerHTML = row[column]; colNode.dataset.label = column; colNode.dataset.searchable = searchableColumns.includes(column) ? "true" : "false"; rowNode.appendChild(colNode); }); content.appendChild(rowNode); appContent.style.display = ''; loader.style.display = 'none'; }); }); } } window.sort_table = sort_table; function sort_table(n) { let table, rows, switching, i, x, y, shouldSwitch, dir, switchcount = 0; table = document.getElementById("_table"); switching = true; dir = "asc"; while (switching) { switching = false; rows = table.rows; for (i = 1; i 
        < (rows.length - 1); i++) { shouldSwitch = false; x = rows[i].getElementsByTagName("TD")[n]; y = rows[i + 1].getElementsByTagName("TD")[n]; if (!x || !y) { continue; } let xVal = parseInt(x.innerHTML.toLowerCase()); let yVal = parseInt(y.innerHTML.toLowerCase()); if (isNaN(xVal)) { xVal = x.innerHTML.toLowerCase(); } if (isNaN(yVal)) { yVal = y.innerHTML.toLowerCase(); } if (dir == "asc") { if (xVal > yVal) { shouldSwitch = true; break; } } else if (dir == "desc") { if (xVal 
        < yVal) { shouldSwitch = true; break; } } } if (shouldSwitch) { rows[i].parentNode.insertBefore(rows[i + 1], rows[i]); switching = true; switchcount ++; } else { if (switchcount == 0 && dir == "asc") { dir = "desc"; switching = true; } } } } window.form_search_change = form_search_change; function form_search_change() { var input, filter, table, tr, td, cell, i, j, count, no_results; input = document.getElementById("form_search"); filter = input.value.toUpperCase(); table = document.getElementById("_table"); tr = table.getElementsByTagName("tr"); no_results = document.getElementById("_no_results_found"); count = 0; for (i = 1; i 
    < (tr.length - 1); i++) { tr[i].style.display = "none"; td = tr[i].getElementsByTagName("td"); for (var j = 0; j 
    < td.length; j++) { if (td[j].dataset.searchable == "false") { continue; } cell = tr[i].getElementsByTagName("td")[j]; if (cell) { if (cell.innerText.toUpperCase().indexOf(filter) > -1) { tr[i].style.display = ""; count++; break; } } } } if (count === 0) { no_results.style.display = "table-row"; } else { no_results.style.display = "none"; } }
    
    </script>

</html>